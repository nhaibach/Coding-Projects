* Date and Time Wizard: DAYOFWEEK.
COMPUTE DAYOFWEEK=XDATE.WKDAY3(DATE).
VARIABLE LABELS DAYOFWEEK.
VARIABLE LEVEL DAYOFWEEK(SCALE).
FORMATS DAYOFWEEK(WKDAY3).
VARIABLE WIDTH DAYOFWEEK(3).
EXECUTE.

*RECODE DAY OF WEEK INTO DAYTYPES.
RECODE DAYOFWEEK (1=2) (2=1) (3=1) (4=1) (5=1) (6=1) (7=2) INTO DAYTYPE.
EXECUTE.

*RECODE HOLIDAY DAYTPE.
IF (DATE=DATE.MDY(5,27,23) OR DATE=DATE.MDY(5,28,23) OR DATE=DATE.MDY(5,29,23) OR DATE=DATE.MDY(7,1,23)
 OR DATE=DATE.MDY(7,2,23) OR DATE=DATE.MDY(7,3,23) OR DATE=DATE.MDY(7,4,23) OR DATE=DATE.MDY(9,4,23)
 OR DATE = DATE.MDY(9,2,23) OR DATE = DATE.MDY(9,3,23)) DayType = 3 .
EXECUTE.

*compute month variable.
* Date and Time Wizard: MONTH.
COMPUTE MONTH=XDATE.MONTH(DATE).
VARIABLE LABELS MONTH.
VARIABLE LEVEL MONTH(SCALE).
FORMATS MONTH(F8.0).
VARIABLE WIDTH MONTH(8).
EXECUTE.

*compute trip variable to account for entrance and exit.
COMPUTE TRIP=PEOPLE/ 2. 
EXECUTE.


MEANS TABLES= PEOPLE TRIP BY MONTH BY DAYTYPE
  /CELLS=SUM.

MEANS TABLES=PEOPLE TRIP BY MONTH BY DAYTYPE
  /CELLS=MEAN.


*RECODE HOLIDAY DAYTPE all holidays.
IF (DATE=DATE.MDY(5,27,23) OR DATE=DATE.MDY(5,28,23) OR DATE=DATE.MDY(5,29,23) OR DATE=DATE.MDY(7,1,23)
 OR DATE=DATE.MDY(7,2,23) OR DATE=DATE.MDY(7,3,23) OR DATE=DATE.MDY(7,4,23) OR DATE=DATE.MDY(6,17,23)
 OR DATE = DATE.MDY(6,18,23) OR DATE = DATE.MDY(6,19,23)OR DATE=DATE.MDY(9,4,23) OR DATE=DATE.MDY(11,10,23)
 OR DATE = DATE.MDY(11,11,23) OR DATE = DATE.MDY(11,12,23) OR DATE=DATE.MDY(10,7,23)
 OR DATE = DATE.MDY(10,8,23) OR DATE = DATE.MDY(10,9,23) OR DATE=DATE.MDY(11,23,23)
 OR DATE = DATE.MDY(11,24,23) OR DATE = DATE.MDY(11,25,23) OR DATE=DATE.MDY(11,26,23)
 OR DATE = DATE.MDY(9,2,23) OR DATE = DATE.MDY(9,3,23)) DayType = 3 .
EXECUTE.
